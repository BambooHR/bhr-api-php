<?php
declare(strict_types=1);
/**
 * PermissionDenied Exception
 * PHP version 8.1
 *
 * @category Class
 * @package  BhrSdk\Exceptions
 * @author   BambooHR
 * @link     https://www.bamboohr.com/api/documentation/
 */

 /**
 * NOTE: This class is auto generated by the update_error_docs script
 */

namespace BhrSdk\Exceptions;

/**
 * PermissionDenied Exception Class
 *
 * Permission denied
 *
 * @category Class
 * @package  BhrSdk\Exceptions
 * @author   BambooHR
 * @link     https://www.bamboohr.com/api/documentation/
 */
class PermissionDeniedException extends ClientException {
	/**
	 * Get potential causes
	 *
	 * @return array<string> List of potential causes
	 */
	public function getPotentialCauses(): array {
		return [
			"API key lacks required permissions",
			"Account restrictions in place",
			"IP address restrictions",
		];
	}

	/**
	 * Get debugging tips
	 *
	 * @return array<string> List of debugging tips
	 */
	public function getDebuggingTips(): array {
		return [
			"Verify your API key has the necessary permissions",
			"Contact your BambooHR administrator to review API access permissions",
			"Check if IP restrictions are in place for API access",
		];
	}

	/**
	 * Constructor
	 *
	 * @param string $message  The error message
	 * @param array  $responseHeaders Additional error data
	 * @param string $responseBody Additional error data
	 */
	public function __construct(string $message, array $responseHeaders = [], $responseBody = null) {
		// Initialize with the parent constructor first
		parent::__construct($message, 403, $responseHeaders, $responseBody);

		// Format a detailed error message with causes and tips if using default message
		$detailedMessage = \BhrSdk\ApiErrorHelper::formatDetailedErrorMessage(
			"Permission denied",
			$this->getPotentialCauses(),
			$this->getDebuggingTips()
		);

		// Update the message
		$this->message = !empty($message) ? $message . "\n\n{$detailedMessage}" : $detailedMessage;
	}
}
